<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <meta name="description" content="All about coding and writing">
  <meta name="keyword" content="Programming, Programming Languages, Algorithms, Tools">
  <meta property="og:site_name" content="CatCoding">
  <meta property="og:title" content="Ruby ç¨‹åºçš„é™æ€åˆ†æï¼šrubytt | CatCoding" />
  <meta property="og:type" content="website" />
  <meta property="og:locale" content="" />
  <meta property="og:description" content="ä¸€ä¸ª Ruby é™æ€åˆ†æå™¨çš„å¼€å‘è¿‡ç¨‹" />
  <meta property="og:image" content=" http://catcoding.me/css/images/logo.png " />
  <link rel="alternate" type="application/rss+xml" title="CatCoding; Feed" href="https://catcoding.me/atom.xml" />

  
<link rel="stylesheet" href="/css/style.css">
<link rel="stylesheet" href="/css/plugins/gitment.css">

  
<link rel="stylesheet" href="/css/style.css">
<link rel="stylesheet" href="/css/plugins/fonts.css">

  
<link rel="stylesheet" href="/css/style.css">
<link rel="stylesheet" href="/css/plugins/code.css">

  
<link rel="stylesheet" href="/css/style.css">
<link rel="stylesheet" href="/css/plugins/prism.css">

  
<link rel="stylesheet" href="/css/style.css">
<link rel="stylesheet" href="/css/plugins/font-awesome.min.css">

  
<script src="/js/qrious.js"></script>
<script src="/js/gitment.js"></script>
<script src="/js/jquery.min.js"></script>
<script src="/js/geopattern.min.js"></script>
<script src="/js/nprogress.min.js"></script>


  
  <link rel="shortcut icon" href="/css/images/favicon.ico">
  
  <title>
    
    Ruby ç¨‹åºçš„é™æ€åˆ†æï¼šrubytt |
    CatCoding
    
  </title>

  <div style='margin:0 auto;width:0px;height:0px;overflow:hidden;'>
    <img src="/css/images/logo.png" width='400px' height='400px' />
  </div>

  
  



<script defer src="https://cloud.umami.is/script.js" data-website-id="9767b9c8-6554-4673-af8c-2d22e00617aa"></script>
<meta name="generator" content="Hexo 5.4.2"></head>

  <body>
    <header class="header fixed-header">
  <div class="header-container">
    <a class="home-link" href="/">
      <div class="logo"></div>
      <span>CatCoding</span>
    </a>
    <ul class="right-list">
      
        <li class="list-item">
          
            <a href="/" class="item-link">Home</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/archives/" class="item-link">Archives</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/project/" class="item-link">Projects</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/links/" class="item-link">Links</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/about/" class="item-link">About</a>
          
        </li>
      

        <li class="list-item" style="margin: 0">
       <a class="icon-small" href="/search">
        <span class="fa-stack fa-lg">
          <i class="fa fa-search fa-stack-1x fa-inverse" style="color:#8ccb8c"></i>
        </span>
       </a>
      </li>

       <li class="list-item" style="margin-left: 3px">
        <a class="icon-small" href="/atom.xml">
         <span class="fa-stack fa-lg">
           <i class="fa fa-rss fa-inverse" style="color:orange"></i>
         </span>
        </a>
       </li>
    </ul>
    
    <div class="menu">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </div>
    <div class="menu-mask">
      <ul class="menu-list">
        
          <li class="menu-item">
            
              <a href="/" class="menu-link">Home</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/archives/" class="menu-link">Archives</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/project/" class="menu-link">Projects</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/links/" class="menu-link">Links</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/about/" class="menu-link">About</a>
            
          </li>
        
      </ul>
    </div>
  </div>
</header>

    <div id="article-banner">
  <h2>Ruby ç¨‹åºçš„é™æ€åˆ†æï¼šrubytt</h2>
  <p class="post-date">2016-12-27</p>
  <div class="arrow-down">
    <a href="javascript:;"></a>
  </div>
</div>


<main class="app-body flex-box">


  <!-- Article START -->
  <article class="post-article">
    <section class="markdown-content"><p><a target="_blank" rel="noopener" href="http://github.com/chenyukang/rubytt">rubytt</a>æ˜¯ä¸€ä¸ª Ruby ç¨‹åºçš„é™æ€åˆ†æå™¨ï¼Œè¿™ä¸ªé¡¹ç›®ä» 16 å¹´å¹´åˆä¸€ç›´åˆ°å¹´åº•ï¼Œæ–­æ–­ç»­ç»­æŒç»­äº†è¿‘ä¸€å¹´ã€‚è¿™é‡Œç¨å¾®æ€»ç»“ä¸€ä¸‹è‡ªå·±çš„å¼€å‘è¿‡ç¨‹ã€‚</p>
<h2 id="0-ç¼˜ç”±"><a href="#0-ç¼˜ç”±" class="headerlink" title="0. ç¼˜ç”±"></a>0. ç¼˜ç”±</h2><p>14 å¹´å¼€å§‹ï¼Œä»æˆ‘è¿›å…¥ DJI ä¹‹åå¼€å§‹æ¥è§¦ Rails å¼€å‘ã€‚Ruby ä¹‹å‰ä¹Ÿæ¥è§¦è¿‡ï¼Œä¸è¿‡éƒ½æ˜¯å†™ä¸€äº›å°è„šæœ¬ä¹‹ç±»çš„ä¸œè¥¿ã€‚æˆ‘ä»¬å‡ ä¹ç”¨ Rails å†™å„ç§ç³»ç»Ÿï¼Œå¼€å‘çš„æ•ˆç‡å¾ˆå¿«ã€‚å¯¹äºç»å¸¸å˜åŠ¨çš„ Web å¼€å‘ rails è¿˜æ˜¯æŒºå¥½çš„ã€‚åœ¨æˆ‘ç»å†è¿‡çš„ä¸€ä¸ªå¯¹æ­£ç¡®æ€§è¦æ±‚å¾ˆé«˜çš„é¡¹ç›®é‡Œï¼Œæœ‰ä¸€æ¬¡ç³»ç»Ÿå‡ºç°ä¸€ä¸ªè‡´å‘½çš„é—®é¢˜ã€‚æˆ‘ä»¬ 6 ä¸ªå¼€å‘äººå‘˜åœ¨å°é»‘å±‹é‡Œé¢è¶³è¶³æ‰¾äº†ä¸€ä¸ªä¸‹åˆã€‚æœ€åå´å‘ç°ä¸è¿‡æ˜¯ä¸€ä¸ª type é”™è¯¯å¼•å…¥çš„ï¼Œå¯¼è‡´åå°ä»»åŠ¡ä¸€ç›´æ‰§è¡Œé”™è¯¯ã€‚åæ¥ç¨å¾®å¤šæƒ³äº†æƒ³ï¼Œè¿™æ ·çš„ç±»å‹é”™è¯¯åº”è¯¥æ˜¯åœ¨å¼€å‘é˜¶æ®µå°±åŠæ—¶å‘ç°çš„ã€‚Rails é¡¹ç›®æ²¡æœ‰æµ‹è¯•æ˜¯ä¸è¡Œçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åç»­è¡¥å……äº†æ›´å¤šå•å…ƒæµ‹è¯•ã€‚å¦å¤–æˆ‘æ‰€ä½¿ç”¨è¿‡çš„é™æ€è¯­è¨€å‡ ä¹éƒ½èƒ½åŠæ—©é¿å…è¿™æ ·çš„é”™è¯¯ï¼Œç‰¹åˆ«æ˜¯åœ¨ä½¿ç”¨è¿‡ OCaml è¿™æ ·çš„å¼ºç±»å‹è¯­è¨€åï¼Œæˆ‘å¯¹ç±»å‹æœ‰äº†æ›´å¼ºçš„åå¥½ã€‚äºæ˜¯æƒ³æˆ‘èƒ½ä¸èƒ½åšä¸€ä¸ªè‡ªåŠ¨æ£€æµ‹å‡ºç±»ä¼¼ bug çš„å·¥å…·ã€‚æ®æˆ‘æ‰€çŸ¥<a target="_blank" rel="noopener" href="https://github.com/yinwang0/rubysonar">ç‹å çš„ rubysonar</a>  å¯ä»¥åšç±»å‹åˆ†æï¼Œäºæ˜¯æˆ‘ checkout å‡ºæ¥çœ‹äº†çœ‹ä»£ç ã€‚Java ä»£ç ä¸æ˜¯ç‰¹åˆ«å¤æ‚ï¼Œä¹Ÿå‘ç°äº†ä¸¤ä¸ªé—®é¢˜å¹¶æäº¤äº† <a target="_blank" rel="noopener" href="https://github.com/yinwang0/rubysonar/pull/12">PR</a>ã€‚ç„¶åè§‰å¾—è¿™ä¸ªä¸œè¥¿è¿˜æ˜¯æ¯”è¾ƒå¥½ç©ï¼Œå¹²è„†å°±è‡ªå·±å¦èµ·ä¸€ä¸ªé¡¹ç›®æ¥ç©ç©ã€‚</p>
<h2 id="1-rubytt-çš„å¼€å‘"><a href="#1-rubytt-çš„å¼€å‘" class="headerlink" title="1. rubytt çš„å¼€å‘"></a>1. rubytt çš„å¼€å‘</h2><p>é¦–å…ˆå¾—ç»™è¿™ä¸ªå‘èµ·ä¸€ä¸ªåå­—ï¼Œæƒ³äº†æƒ³å°± rubytt å§ï¼Œå…¶å®å°±æ˜¯â€ruby to typeâ€ çš„æ„æ€å§ã€‚ç„¶åè¯­è¨€è¿˜æ˜¯ç”¨äº†æœ€è¿‘ä¸šä½™ä½¿ç”¨å¾—æ¯”è¾ƒå¤šçš„ OCamlã€‚è¿™å¯èƒ½å¯¹åæœŸå…¶ä»–å¼€å‘å‚ä¸è¿›æ¥ä¸åˆ©ï¼Œä¸è¿‡ä¹Ÿæ— æ‰€è°“äº†ï¼Œä¸šä½™çš„é¡¹ç›®å…ˆä¾è‡ªå·±çš„åå¥½å§ã€‚</p>
<h3 id="parser"><a href="#parser" class="headerlink" title="parser"></a>parser</h3><p>é¦–å…ˆé¢ä¸´çš„é—®é¢˜æ˜¯ parserã€‚rubysonar çš„ parser ä¹Ÿæ˜¯ä¾é  Ruby è‡ªå·±çš„<a target="_blank" rel="noopener" href="http://ruby-doc.org/stdlib-2.0.0/libdoc/ripper/rdoc/Ripper.html">ripper</a>ã€‚ä¸»è¦æ˜¯ parser å¤ªè¿‡ç¹çï¼Œå¦‚æœä»å¤´å¼€å§‹å†™æ•´ä¸ªå‘ä¼°è®¡æ˜¯å¡«ä¸å®Œäº†ã€‚æ‰€ä»¥æˆ‘ä¹Ÿå°±ç›´æ¥æ‹¿æ¥äº† rubysonar çš„<a target="_blank" rel="noopener" href="https://github.com/yinwang0/rubysonar/blob/master/src/main/resources/org/yinwang/rubysonar/ruby/dump_ruby.rb">dump_ruby.rb</a>ã€‚dump_ruby æŠŠ ruby æºæ–‡ä»¶ä½œä¸ºè¾“å…¥ï¼Œè¾“å‡ºä¸€ä¸ª json æ–‡ä»¶ä½œä¸ºåç«¯åˆ†æå™¨çš„è¾“å…¥ã€‚è¿™é‡Œæˆ‘åšäº†ä¸€äº›æ”¹åŠ¨ï¼Œrubysonar é‡Œé¢æ˜¯èµ·æ¥ä¸€ä¸ªè¿›ç¨‹ï¼ŒæŠŠ dump_ruby å¯åŠ¨èµ·æ¥ï¼Œç”¨ç®¡é“çš„æ–¹å¼ä¸€ä¸ªä¸ª parse æºç¨‹åºã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯é¿å… ruby è§£é‡Šå™¨é¢‘ç¹å¯åŠ¨ï¼Œé¿å…æ•´ä¸ªé€Ÿåº¦ä¼šè¢«æ‹–æ…¢ã€‚æˆ‘è§‰å¾—è¿˜ä¸å¦‚è®© dump_ruby ä¸€æ¬¡æ¥æ”¶å¤šä¸ªæºç¨‹åºï¼Œç”šè‡³å¯ä»¥æ˜¯ç”¨ parallel è¿™ä¸ªåº“æ¥åšå¹¶è¡Œã€‚è¿™æ ·çš„ç»“æœæ˜¯ parsing çš„é€Ÿåº¦ç¡®å®å¿«äº†å¾ˆå¤šï¼Œä¸€èˆ¬å¤§ç‚¹çš„é¡¹ç›®åœ¨ 10s ä»¥å†…å¯ä»¥å®Œæˆã€‚è¿™æ ·é¡¹ç›®çš„å¤§æ¦‚æµç¨‹å¦‚ä¸‹ï¼š</p>
<p><img src="/images/rubytt.png" alt="rubytt" class="img-center" style="width:320px;height:310px;"/><span class="image-caption">rubytt</span></p>
<h3 id="type-annoation"><a href="#type-annoation" class="headerlink" title="type annoation"></a>type annoation</h3><p>æˆ‘æƒ³åšè‡ªåŠ¨çš„ç±»å‹é”™è¯¯æ£€æŸ¥ï¼Œæ‰€ä»¥éœ€è¦ç±»å‹åˆ†æã€‚dump_ruby å‡ºæ¥çš„ç»“æœé‡Œé¢æ˜¯å¸¦ä¸€äº›åŸºæœ¬ç±»å‹çš„ï¼Œç±»å‹åˆ†æè¿‡ç¨‹ rubysonar é‡Œé¢æœ‰ä¸€ä¸ªåŸºæœ¬è¿‡ç¨‹äº†ã€‚ç„¶åå¯¹äº Rails é¡¹ç›®æ¥è¯´ï¼Œæˆ‘ä»¬å¾ˆå¤šç±»å‹éƒ½å¯ä»¥åœ¨ db/schema.rb é‡Œé¢å¯ä»¥åˆ†æå‡ºæ¥ï¼Œæ‰€ä»¥å¦‚æœæˆ‘æŠŠ schema.rb æ–‡ä»¶ä¹Ÿæ‰«æåˆ†æä¸€è¾¹ï¼Œå°±å¯ä»¥ä¸ºè¿™äº› model åŠ ä¸Šä¸å°‘ç±»å‹ã€‚ç»“æœåšå‡ºæ¥è¿˜å¯ä»¥ï¼Œè‡³å°‘ç›®å‰å¯ä»¥åˆ†æå‡ºæ¥å¾ˆå¤š rubysonar æ²¡æœ‰çš„ç±»å‹ã€‚è¿è¡Œ<code>rubytt -s source_dir -t type -o res</code>æŠŠç»“æœè¾“å‡ºåˆ° res ç›®å½•ã€‚è¿™é‡Œè¿˜æœ‰ä¸å°‘ä¸œè¥¿æœªåšï¼Œæ¯”å¦‚å‡½æ•°çš„åˆ†æè¿˜æ˜¯å¾ˆå¤æ‚ï¼Œç›®å‰åšäº†ä¸€ä¸ªåˆæ­¥ã€‚ç±»å‹é”™è¯¯æŠ¥å‡ºå¯ä»¥åšä¸€äº›äº†ï¼Œä½†æ˜¯è¿˜æœªæ¥å¾—åŠå®ç°ã€‚å› ä¸ºæˆ‘çªç„¶æƒ³åˆ°å¦å¤–ä¸€ä¸ªæœ‰è¶£çš„ä¸œè¥¿ã€‚</p>
<h3 id="visualize-rails-project"><a href="#visualize-rails-project" class="headerlink" title="visualize rails project"></a>visualize rails project</h3><p>æˆ‘æ—¢åœ¨ traverse æ•´ä¸ª ASTï¼Œå¯ä»¥åšå¾ˆå¤šå¥½ç©çš„äº‹å•Šã€‚æ¯”å¦‚æŠŠç±»ä¹‹é—´çš„ç»§æ‰¿å…³ç³»æ‰¾å‡ºæ¥ï¼Œåšä¸€ä¸ªç±»çš„ç»§æ‰¿å…³ç³»å›¾ã€‚äºæ˜¯å°±æœ‰äº†<a href="/images/rubytt_class.png">ç±»ä¼¼è¿™æ ·çš„ç»“æœ (çœ‹å¤§å›¾)</a>ï¼š</p>
<p><img src="/images/rubytt_class.png" alt="rubytt_class" class="img-center" style="width:320px;height:300px;"/><span class="image-caption">rubytt_class</span></p>
<p>æ—¢ç„¶æˆ‘èƒ½è§£æ schema.rbï¼Œä¹Ÿå¯ä»¥æŠŠæ•°æ®æ¨¡å‹ç»™å±•ç¤ºå‡ºæ¥ï¼Œç„¶åå†é€šè¿‡ model æ–‡ä»¶é‡Œé¢åˆ†ææ¨¡å‹ä¹‹é—´çš„å…³ç³» (has_one, has_many ç­‰)ï¼Œäºæ˜¯å°±æœ‰äº†<a href="/images/rubytt_db.png">è¿™æ ·çš„ç»“æœ</a>ï¼š</p>
<p><img src="/images/rubytt_db.png" alt="rubytt_db" class="img-center" style="width:320px;height:300px;"/><span class="image-caption">rubytt_db</span></p>
<p>ä¸è¿‡åšäº†ä¸€äº›ä¹‹åæˆ‘å‘ç°è¿™ä¸¤ä¸ª feature æœ‰ç‚¹é¸¡è‚‹ã€‚ç‰¹åˆ«æ˜¯ç¬¬ä¸€ä¸ªï¼Œè¦æ‰¾å‡º ruby ç¨‹åºå†…éƒ¨å¯¹è±¡ä¹‹é—´çš„ç»§æ‰¿å…³ç³»å…¶å®å¾ˆç®€å•ï¼Œæ¯”å¦‚æˆ‘ä¹‹å‰å†™è¿‡çš„<a target="_blank" rel="noopener" href="http://cyukang.com/2012/12/26/browser-objs-in-ruby.html">ä¸€ç¯‡æ–‡ç« </a>ã€‚ç¬¬äºŒä¸ªæ¨¡å‹çš„å…³ç³»å›¾è¿˜å¥½ï¼Œä¸è¿‡é¡¹ç›®ç¨å¾®å¤§ä¸€äº›çš„æ—¶å€™è¿™äº›å›¾çœ‹èµ·æ¥å¾ˆå¤æ‚ã€‚</p>
<h3 id="variable-bug-finder"><a href="#variable-bug-finder" class="headerlink" title="variable bug finder"></a>variable bug finder</h3><p>åœ¨åšå®Œä¸Šé¢ä¸¤ä¸ªè›‹ç–¼çš„ feature ä¹‹åï¼Œç¢°å·§ç¢°åˆ°äº†é¡¹ç›®é‡Œé¢å¦å¤–ä¸€ä¸ª bugã€‚æ˜¯å› ä¸ºé‡æ„çš„æ—¶å€™ä¸å°å¿ƒå¼•å…¥äº†ä¸€ä¸ª copy &amp; paste  bugã€‚ç±»ä¼¼ä»£ç å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby">event <span class="token operator">=</span> <span class="token punctuation">(</span>order<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token string-literal"><span class="token string">'success'</span></span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string-literal"><span class="token string">'success'</span></span> <span class="token operator">:</span> <span class="token string-literal"><span class="token string">'fail'</span></span>
Job<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string-literal"><span class="token string">'Worker'</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string-literal"><span class="token string">'order_id'</span></span> <span class="token operator">=></span> order<span class="token punctuation">.</span>id<span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">'event'</span></span> <span class="token operator">=></span> <span class="token string-literal"><span class="token string">'success'</span></span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>å¯ä»¥çœ‹åˆ°è¿™ä¸ª event æœ¬æ¥åº”è¯¥ä½¿ç”¨çš„ï¼Œç»“æœå´å› ä¸ºé‡æ„çš„æ—¶å€™ copy äº†ä»£ç å¿˜è®°æŠŠ<code>&#39;event&#39; =&gt; &#39;success&#39;</code>æ”¹æˆ<code>&#39;event&#39; =&gt; event</code>ã€‚event è¿™ä¸ªå˜é‡æ˜¯æœªä½¿ç”¨çš„å˜é‡ï¼Œå¯¹äºç¼–è¯‘å‹è¯­è¨€æ¥è¯´è¿™æ ·çš„é—®é¢˜æ˜¯å¯ä»¥åœ¨ç¼–è¯‘çš„æ—¶å€™å‘å‡ºæŠ¥è­¦çš„ã€‚å› ä¸ºä¸€ä¸ªå˜é‡æœªä½¿ç”¨å¿…ç„¶æ„å‘³è¿™è¦ä¹ˆæ˜¯å†—ä½™ä»£ç ï¼Œè¦ä¹ˆæ˜¯ bugã€‚é‚£æˆ‘å¯å¦é€šè¿‡ rubytt ç»™å‡ºç±»ä¼¼æŠ¥è­¦ï¼Ÿç„¶åæˆ‘å°±ç»§ç»­å†™äº†è¿™ä¹ˆä¸€ä¸ª checkerï¼Œå»æ£€æŸ¥ ruby ç¨‹åºä¸­å„ç§æ²¡ä½¿ç”¨çš„å˜é‡ã€‚æœ€åè¿˜çœŸèƒ½æ‰¾å‡ºé¡¹ç›®ä¸­ä¸€äº›å…¶ä»–çš„ç±»ä¼¼é—®é¢˜ï¼Œæ¯”å¦‚ï¼š</p>
<pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby">result <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
trans <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>transactions<span class="token punctuation">.</span>where<span class="token punctuation">(</span><span class="token operator">..</span>blah<span class="token operator">...</span><span class="token punctuation">)</span>
trans<span class="token punctuation">.</span><span class="token keyword">each</span> <span class="token keyword">do</span> <span class="token operator">|</span>tran<span class="token operator">|</span>
   result<span class="token punctuation">[</span><span class="token symbol">:amount</span><span class="token punctuation">]</span> <span class="token operator">=</span> trans<span class="token punctuation">.</span>amount_cent  <span class="token operator">&lt;</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> bug<span class="token operator">:</span> <span class="token command-literal"><span class="token command string">`trans`</span></span> is typo of <span class="token string-literal"><span class="token string">'tran'</span></span>
   <span class="token operator">...</span>blah<span class="token operator">...</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å½“ç„¶è¿˜æ˜¯èƒ½æ‰¾åˆ°å‡½æ•°ä¸­æœªä½¿ç”¨çš„å‚æ•°ç­‰é—®é¢˜ã€‚ä¿®å¤çš„åŠæ³•æ˜¯å¦‚æœç¡®å®šè¿™äº›å˜é‡æ˜¯ä¸è¢«ä½¿ç”¨çš„ï¼Œå°±åœ¨å‰é¢åŠ <code>_</code>ï¼Œè¿™æ · rubytt è¿™æ ·çš„ lint ç±»æ£€æŸ¥å·¥å…·å°±è·³è¿‡ã€‚åç»­æˆ‘ä¹Ÿæ­£åœ¨åšæœªå®šä¹‰å˜é‡çš„æ£€æŸ¥ã€‚</p>
<h2 id="2-OCaml-çš„ç¨‹åºå‘å¸ƒ"><a href="#2-OCaml-çš„ç¨‹åºå‘å¸ƒ" class="headerlink" title="2. OCaml çš„ç¨‹åºå‘å¸ƒ"></a>2. OCaml çš„ç¨‹åºå‘å¸ƒ</h2><p>åœ¨åšå®Œä¸Šé¢çš„å‡ ä¸ª feature ä¹‹åï¼Œæˆ‘è§‰å¾—å¯ä»¥å°è¯•ç€æŠŠè¿™ä¸ªé¡¹ç›®æ¨å¹¿ä¸€ä¸‹ç»™åŒäº‹ä»¬ç©ç©ã€‚å¦‚æœè®©ä»æ¥æ²¡æ¥è§¦è¿‡ OCaml çš„æœ‹å‹ä»å¤´å¼€å§‹ç¼–è¯‘å®‰è£…ä¼šæ˜¾å¾—å¾ˆéº»çƒ¦ã€‚æ‰€ä»¥æˆ‘å°±å°è¯•ç€æŠŠ rubytt åˆå¹¶åˆ° OCaml çš„åŒ…ç®¡ç†ä»“åº“ã€‚äºæ˜¯åœ¨ç»è¿‡å‡ æ¬¡å’Œ travis CI çš„æ–—äº‰åï¼Œç»ˆäºå‘å¸ƒäº†<a target="_blank" rel="noopener" href="https://opam.ocaml.org/packages/rubytt/rubytt.0.1/">rubytt.0.1</a> ã€‚</p>
<p>å®‰è£…æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gem <span class="token function">install</span> parallel ruby-progressbar
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> --force-yes ocaml ocaml-native-compilers camlp4-extra opam
// brew <span class="token function">install</span> opam   <span class="token punctuation">(</span>MacOS<span class="token punctuation">)</span>
<span class="token builtin class-name">eval</span> <span class="token variable"><span class="token variable">`</span>opam config <span class="token function">env</span><span class="token variable">`</span></span>
opam <span class="token function">install</span> rubytt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>OCaml çš„åœˆå­æ¯”è¾ƒå°ä¼—ï¼Œä¸è¿‡å…¶å®å¾ˆå¤šå·¥å…·è¿˜æ˜¯æŒºå¥½ç”¨çš„ï¼Œæ¯”å¦‚è¿™ä¸ª OPAM åŒ…ç®¡ç†å™¨ã€‚</p>
<h2 id="3-å…¶ä»–å¿ƒå¾—"><a href="#3-å…¶ä»–å¿ƒå¾—" class="headerlink" title="3. å…¶ä»–å¿ƒå¾—"></a>3. å…¶ä»–å¿ƒå¾—</h2><p>åšè¿™ä¸ªç¨‹åºè¿™ä¹ˆä¹…ï¼Œé™¤äº†å¥½ç©è¿˜æ˜¯æ”¶è·ä¸å°‘ã€‚</p>
<p>  OOP å’Œ FP å“ªä¸ªå¥½ï¼Ÿé€šè¿‡è¿™ä¸ªé¡¹ç›®çš„å®è·µï¼Œæˆ‘å¥½å¥½ä½“ä¼šäº†ä¸€æŠŠ FP å†™ç¨å¾®å¤§äº›çš„ç¨‹åºçš„æ„Ÿè§‰ã€‚è¯´ä¸ä¸Šå“ªä¸ªå¥½ï¼Œæˆ‘å€’è®¤ä¸º type ç¡®å®å¾ˆé‡è¦ï¼Œrubytt çš„è¿‡ç¨‹ä¸­è‡ªåŠ¨ç±»å‹æ¨å¯¼å¸®æˆ‘å‘ç°äº†å¥½å¤šä»£ç é”™è¯¯ã€‚ç¼–ç¨‹è¯­è¨€åº”è¯¥è®©ç¨‹åºå‘˜èƒ½å¤Ÿç²¾ç¡®æ— è¯¯åœ°è¡¨è¾¾è‡ªå·±ï¼Œå°½é‡åœ°é¿å…äººä¸ºå¼•å…¥çš„é”™è¯¯ã€‚</p>
<p>  æ„å»ºæµ‹è¯•è„šæ‰‹æ¶ï¼Œè¿™ä¹Ÿæ˜¯ç¬¬ä¸€ä»½å·¥ä½œå¸¦ç»™æˆ‘çš„ä¹ æƒ¯ã€‚æŠŠæ¯ä¸€ä¸ª feature æˆ–è€… bug éƒ½å†™æµ‹è¯•æ¥è¦†ç›–ã€‚æ¯æ¬¡æäº¤çš„æ—¶å€™éƒ½ review ä¸€ä¸‹æµ‹è¯•ç”¨ä¾‹çš„æ”¹åŠ¨ï¼Œè¿™æ ·æ‰èƒ½ä¸æ–­ä¿æŒè´¨é‡ã€‚</p>
<p>  å¸Œæœ›æ¥å¹´èƒ½ç»§ç»­ä¿æŒå¯¹è¿™ä¸ªç¨‹åºçš„çƒ­æƒ…ã€‚</p>
</section>

    <p></p>
    <!-- äºŒç»´ç  START -->
    
        <div class="qrcode">
            <img src="/images/wechat-qr-code.jpg" height="160" width="160">
            <figcaption>å…¬å·åŒæ­¥æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ‘»</figcaption>
      </div>
    

    <!-- Tags START -->
    
      <div class="tags">
        <span>Tags:</span>
        
  <a href="/tags#Programming" >
    <span class="tag-code">Programming</span>
  </a>

  <a href="/tags#Ruby" >
    <span class="tag-code">Ruby</span>
  </a>

  <a href="/tags#OCaml" >
    <span class="tag-code">OCaml</span>
  </a>

      </div>
    
    <!-- Tags END -->
    <!-- NAV START -->
    
  <div class="nav-container">
    <!-- reverse left and right to put prev and next in a more logic postition -->
    
      <a class="nav-left" href="/2017/01/24/disease-of-programmer.html">
        <span class="nav-arrow">â† </span>
        
          ç¨‹åºå‘˜ç—…
        
      </a>
    
    
      <a class="nav-right" href="/2016/12/11/qianlong-history.html">
        
          è¯»ã€Šé¥¥é¥¿çš„ç››ä¸–ã€‹
        
        <span class="nav-arrow"> â†’</span>
      </a>
    
  </div>

    <!-- NAV END -->

    <!-- äºŒç»´ç  END -->
    
      <!-- No Comment -->
    



    <script src="https://utteranc.es/client.js"
      repo="chenyukang/chenyukang.github.io"
      issue-term="pathname"
      theme="github-light"
      crossorigin="anonymous"
      async>
    </script>


  </article>
  <!-- Article END -->
  <!-- Catalog START -->
  
    <aside class="catalog-container">
  <div class="toc-main">
    <strong class="toc-title"></strong>
    
      <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#0-%E7%BC%98%E7%94%B1"><span class="toc-nav-text">0. ç¼˜ç”±</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#1-rubytt-%E7%9A%84%E5%BC%80%E5%8F%91"><span class="toc-nav-text">1. rubytt çš„å¼€å‘</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#parser"><span class="toc-nav-text">parser</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#type-annoation"><span class="toc-nav-text">type annoation</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#visualize-rails-project"><span class="toc-nav-text">visualize rails project</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#variable-bug-finder"><span class="toc-nav-text">variable bug finder</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#2-OCaml-%E7%9A%84%E7%A8%8B%E5%BA%8F%E5%8F%91%E5%B8%83"><span class="toc-nav-text">2. OCaml çš„ç¨‹åºå‘å¸ƒ</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#3-%E5%85%B6%E4%BB%96%E5%BF%83%E5%BE%97"><span class="toc-nav-text">3. å…¶ä»–å¿ƒå¾—</span></a></li></ol>
    
  </div>
</aside>

  
  <!-- Catalog END -->
</main>

<script>
  (function () {
    var url = 'http://catcoding.me/2016/12/27/rubytt.html';
    var banner = ''
    if (banner !== '' && banner !== 'undefined' && banner !== 'null') {
      $('#article-banner').css({
        'background-image': 'url(' + banner + ')'
      })
    } else {
      $('#article-banner').geopattern(url)
    }
    $('.header').removeClass('fixed-header')

     // error image
    $(".markdown-content img").on('error', function() {
      $(this).attr('src', 'http://file.muyutech.com/error-img.png')
      $(this).css({
        'cursor': 'default'
      })
    })

    // zoom image
    $(".markdown-content img").on('click', function() {
      var src = $(this).attr('src')
      if (src !== 'http://file.muyutech.com/error-img.png') {
        var imageW = $(this).width()
        var imageH = $(this).height()

        var zoom = ($(window).width() * 0.95 / imageW).toFixed(2)
        zoom = zoom < 1 ? 1 : zoom
        zoom = zoom > 2 ? 2 : zoom
        var transY = (($(window).height() - imageH) / 2).toFixed(2)

        $('body').append('<div class="image-view-wrap"><div class="image-view-inner"><img src="'+ src +'" /></div></div>')
        $('.image-view-wrap').addClass('wrap-active')
        $('.image-view-wrap img').css({
          'width': `${imageW * 3 / 4}`,
          'transform': `translate3d(0, ${transY}px, 0) scale3d(${zoom}, ${zoom}, 1)`
        })
        $('html').css('overflow', 'hidden')

        $('.image-view-wrap').on('click', function() {
          $(this).remove()
          $('html').attr('style', '')
        })
      }
    })

    // qrcode
    var qr = new QRious({
      element: document.getElementById('share-qrcode'),
      value: document.location.href
    });

  })();
</script>

    <div class="scroll-top">
  <span class="arrow-icon"></span>
</div>
    <footer class="app-footer" id="footer">
    <p class="copyright">
        &copy;
        2025 | Proudly powered by <a href="https://hexo.io" target="_blank">Hexo</a> with <a target="_blank" rel="noopener" href="https://github.com/yanm1ng/hexo-theme-vexo">Vexo</a>
    </p>
</footer>

<script>
    function async(u, c) {
        var d = document,
            t = 'script',
            o = d.createElement(t),
            s = d.getElementsByTagName(t)[0];
        o.src = u;
        if (c) {
            o.addEventListener('load', function(e) {
                c(null, e);
            }, false);
        }
        s.parentNode.insertBefore(o, s);
    }
</script>
<script>
    async("//catcoding.me/js/fastclick.min.js", function() {
        FastClick.attach(document.body);
    })
</script>


<script src="/js/script.js"></script>

  </body>
</html>